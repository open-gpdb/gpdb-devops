# --------------------------------------------------------------------
# Container Initialization Script
# --------------------------------------------------------------------


# --------------------------------------------------------------------
# Configure SSH access
# --------------------------------------------------------------------
mkdir -p /home/gpadmin/.ssh
chmod 700 /home/gpadmin/.ssh

eval "$(ssh-agent -s)"
ssh-add ~/.ssh/id_rsa
sudo service ssh start
ssh -o StrictHostKeyChecking=no gpadmin@$(hostname) "echo 'Hello world'"


# --------------------------------------------------------------------
# Display a Welcome Banner
# --------------------------------------------------------------------
# The following ASCII art and welcome message are displayed when the
# container starts. This banner provides a visual indication that the
# container is running in the Greenplum Build Environment.
# --------------------------------------------------------------------
cat <<-'EOF'

======================================================================

                          ++++++++++       ++++++
                        ++++++++++++++   +++++++
                       ++++        +++++ ++++
                      ++++          +++++++++
                   =+====         =============+
                 ========       =====+      =====
                ====  ====     ====           ====
               ====    ===     ===             ====
               ====            === ===         ====
               ====            ===  ==--       ===
                =====          ===== --       ====
                 =====================     ======
                   ============================
                                     =-----=
        __  __                     _     _         _____  ____  
       |  \/  |                   | |   | |       |  __ \|  _ \ 
       | \  / | ___  _ __ ___  ___| |__ | | ____ _| |  | | |_) |
       | |\/| |/ _ \| '__/ _ \/ __| '_ \| |/ / _` | |  | |  _ < 
       | |  | | (_) | | | (_) \__ \ | | |   < (_| | |__| | |_) |
       |_|  |_|\___/|_|  \___/|___/_| |_|_|\_\__,_|_____/|____/ 
----------------------------------------------------------------------

EOF